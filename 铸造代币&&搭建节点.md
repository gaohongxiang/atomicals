# 铸造代币

## 通过官网铸造代币

- atom官方网站：https://atomicalmarket.com/inscribe 
- satsx官方网站：https://www.satsx.io/atomicals

这种方式时通过公共节点来铸造，热度高的时候很容易造成网站崩溃，不稳定。

## 通过atomicals-js铸造代币

### 安装node

https://nodejs.org/en

终端输入命令查看node版本
```
node -v
```

### 安装git

https://git-scm.com/downloads

终端输入命令查看node版本
```
git -v
```

### 克隆并编译atomicals-js项目

```
# 创建工作目录
mkdir atomicals && cd atomicals

# github 克隆
git clone https://github.com/atomicals/atomicals-js.git

# 安装依赖
cd atomicals-js && npm install

# 编译（完成后会有一个dist文件夹）
npm run build

# 安装 yarn（后续命令会用到）
npm install -g yarn
```

### 创建钱包
```
yarn cli wallet-init
```
执行创建钱包命令后会在当前目录下会生成 wallet.json 钱包信息，注意保存好 wallet.json 钱包文件
>说明：创建钱包后，会自动生成2个地址，Primary Address和Funding Address，其中Primary是用于接收Atomicals生态资产的，比如ARC20代币、图片NFT等，Funding是用于铸造（挖矿）过程的中转钱包，通常是往Funding地址中存入相应数量的BTC，用于铸造。可以提前充值进去。

### 常用命令


1、铸造FT币命令
```
yarn cli mint-dft atom --satsbyte 30
```
- 'atom'指铸造的代币名称，根据实际情况修改
- '--satsbyte 30' 是设置的gas，注意这里设置的gas，与实际上链的gas是1.8-2倍的关系，比如这里设置30，实际上链gas是54-60sats/vB。

>举例：实际gas是80，需要快点打上gas拉高10，按1:1.8计算，需要设置gas为90/1.8=50

2、铸造Realm命令
```
yarn cli mint-realm btc --satsbyte 30 --satsoutput 1000 --bitworkc 3165
```

3、铸造图片NFT命令
```
yarn cli mint-nft "E:\Crypto\NFT\CryptoPunks\punk0000.png" --satsbyte 30 --satsoutput 1000 --bitworkc 3165
```

铸造命令给出后会如果代币还有的话会给出收款二维码，地址以及需要的金额，充钱进去就会开始挖矿，挖矿成功会提示success。提前充钱进去会省很多时间。

4、查询余额命令
```
# 查询atom余额
yarn cli balances atom
```

5、查总量
```
# 查询atom总量
yarn cli location atom
```

6、转移代币
```
# 转移atom
yarn cli transfer-ft atom
```
参考：https://mirror.xyz/xiaonezhalab.eth/BWpbBheadJFkjaTE4kzrwX5Yp_kLw5TAwagrfD2qFp4

### 常见问题

1、命令卡住

命令卡住了按`ctrl c`终止，然后重新输入命令

2、多打

1个钱包1次打一张，想多打的话可以提前准备多个钱包。
1. 将wallet.json文件暂存到别的地方，复制atomicals文件夹，然后再将wallet.json文件转移回来
2. 将复制的atomicals文件夹多创建几份，每个文件夹里运行`yarn cli wallet-init`命令，生成新的钱包
3. 给钱包转钱
4. 每个atomicals文件夹开一个终端，铸造代币


# 搭建私有Atomicals节点

>前置条件：一个2TB的SSD固态硬盘

截止到2023年3月，比特币全节点的占用空间为464GB，并且每个月都会增加5-10GB，因此你需要一块容量足够的硬盘，这不只是为了满足当前的需求，我们还要为未来几年预留空间。2TB 的 SSD 硬盘价格现在已经很便宜了，请不要考虑 HDD 机械硬盘，亲测读写速度感人。在同步区块这种需要高频读写的操作中，同步所需时间能轻松飙到几个星期甚至更长，慢到你怀疑人生。

![image](https://github.com/gaohongxiang/atomicals/assets/33713367/92bbf577-6a06-4722-9ecd-1229eea598bd)


## 一、同步比特币节点

#### 1、下载打包好的过往比特币数据

由于比特币数据比较大，如果全部用bitcoin core同步的话速度会比较慢。可以提前下载别人打包好的过往比特币数据，解压后存到数据文件夹，那么再用bitcoin core同步时这部分数据就不必同步了，直接同步剩下的数据就可以了，节省时间。

打包好的节点数据（截止到2022.8）
- https://pan.quark.cn/s/4c3b98e42c1f#/list/share

在开通会员的情况下，大概9小时下载完毕。

全部下载完成后，用`7-zip`解压，数据备用。

#### 2、下载bitcoin core并配置

官网：https://bitcoincore.org/en/download/

根据自己的操作系统下载对应压缩版本，然后解压，并移动到自己的移动硬盘中

```
进入解压缩文件，创建数据存储文件夹，比如 bitcoin_data，后续所有的数据都存在这个文件夹里。
```

运行bitcoin core，初次运行要选择比特币数据存锤位置，这里存储在自己的移动硬盘中。即刚创建的数据文件夹`bitcoin_data`。

![选择数据存储位置](https://github.com/gaohongxiang/atomicals/assets/33713367/93b28d24-4c32-40a7-a1fb-f1df5df62ab6)


找到`设置-选项`，根据下图配置

![bitcoin core 配置](https://github.com/gaohongxiang/atomicals/assets/33713367/48b4ef91-387e-446e-b0f1-db4e030e992a)

`bitcoin.conf`配置文件配置内容如下
```
# 指示比特币节点运行为完整节点（full node），允许其他节点连接并获取区块链数据
server=1
# 将比特币节点设置为后台运行的守护进程，而不是在命令行或图形界面中交互式地运行
daemon=1
# 启用事务索引（transaction index），允许比特币节点通过事务哈希快速查找和检索特定的交易。当该选项设置为 1 时，比特币节点会从第一个区块开始索引所有的交易
txindex=1
# 配置 ZeroMQ 发布原始区块数据的地址和端口。ZeroMQ 是一种消息传递库，用于在比特币网络中实时传输数据。
zmqpubrawblock=tcp://127.0.0.1:28332
zmqpubrawtx=tcp://127.0.0.1:28333

用于比特币节点的远程过程调用（RPC）身份验证的用户名和密码
rpcuser=<自行替换>
rpcpassword=<自行替换>
# 更安全的验证方式是用rpcauth，如下
# rpcauth=electrumx:XXX

# 添加大陆节点确保稳定极速同步
# 大陆节点查找：https://bitnodes.io/nodes/?q=China
addnode = 120.79.71.72:8333
addnode = 175.27.222.132:8333
addnode = 42.231.189.65:8333
addnode = 194.156.99.41:10001
addnode = 124.222.39.240:8333
addnode = 27.148.206.140:8333

# 通过rpcbind=0.0.0.0和rpcallowip的设置灵活控制IP地址对节点 RPC 接口的访问，以增加安全性。
# 指定比特币节点监听的 RPC 绑定地址。设置为 0.0.0.0 表示节点将接受来自所有网络接口的连接请求。换句话说，它允许从任意 IP 地址访问节点的 RPC 接口
rpcbind=0.0.0.0
# rpcallowip指定允许访问节点 RPC 接口的 IP 地址。
# 设置为 127.0.0.1 表示允许本地主机访问节点的 RPC 接口，即只有在同一台机器上运行的程序可以连接和调用节点的 RPC
rpcallowip=127.0.0.1
# 设置为 192.168.0.0/16 表示允许具有以 192.168 开头的局域网 IP 地址的设备连接和调用节点的 RPC 接口。这通常包括您的本地网络中的设备
rpcallowip=192.168.0.0/16
# 设置为 172.0.0.0/8 表示允许具有以 172 开头的默认 Docker 容器网络 IP 地址的设备连接和调用节点的 RPC 接口
rpcallowip=172.0.0.0/8
```

配置好后重启bitcoin core生效。

#### 3、移动打包好的数据

将第一步下载的打包好的比特币数据移动到`bitcoin_data`文件夹下，替换掉`blocks`和`chainstate`这两个文件夹。

![image](https://github.com/gaohongxiang/atomicals/assets/33713367/cec0eae5-f0f8-42eb-b19c-cbe95d68f973)

#### 4、同步比特币数据

再次打开bitcoin core软件，数据开始同步，可以看到，我们下载好的数据不需要重新同步了，只需要同步剩下的数据就好了，耐心等待，需要几个小时才能同步完。同步完成后就有了比特币全节点数据！

## 二、同步 ATOM 的索引数据

#### 1、安装docker

官网：https://www.docker.com/

注册并登录

#### 2、拉取atomicals-electrumx-docker并配置

```
git clone https://github.com/Next-DAO/atomicals-electrumx-docker.git
```
在atomicals-electrumx-docker目录创建`.env`文件

内容如下
```
DAEMON_URL=用户名:密码@<ip>:8332
```
把<ip>换成你比特币全节点所在的ip，如果在本地或者同一个机器，ip就填localhost或者127.0.0.1

下载对应的docker镜像
```
docker-compose pull
```
启动镜像
```
docker-compose up -d
```

打印日志查看区块同步进度
```
docker-compose logs -f
```
只有等区块完全同步了才能开始用


使用方法
1、关闭/停止Docker；

2、把原electrumx-data文件内的已有数据删除；

3、把下载好的文件解压缩到electrumx-data文件夹；

4、重启Docker（还需要一小段时间同步至最新高度）；

大家可以关注下 @theNextDAO 的 @millsonzhou 老哥。

推荐使用qBittorrent工具下载。

磁力链接：
```
magnet:?xt=urn:btih:7KW5OXSWUQ2EFF57URE42GBRL2XCN5AI&dn=ElectrumX-Data-20231114&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.opentrackr.org%3A1337%2Fannounce&tr=https%3A%2F%2Ftracker2.ctix.cn%3A443%2Fannounce&tr=https%3A%2F%2Ftracker1.520.jp%3A443%2Fannounce&tr=udp%3A%2F%2Fopen.tracker.cl%3A1337%2Fannounce&tr=udp%3A%2F%2Fopentracker.i2p.rocks%3A6969%2Fannounce&tr=udp%3A%2F%2Fopen.demonii.com%3A1337%2Fannounce&tr=udp%3A%2F%2Ftracker.openbittorrent.com%3A6969%2Fannounce&tr=http%3A%2F%2Ftracker.openbittorrent.com%3A80%2Fannounce&tr=udp%3A%2F%2Fopen.stealth.si%3A80%2Fannounce&tr=udp%3A%2F%2Ftracker.torrent.eu.org%3A451%2Fannounce&tr=udp%3A%2F%2Fexodus.desync.com%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker1.bt.moack.co.kr%3A80%2Fannounce&tr=udp%3A%2F%2Ftracker.tiny-vps.com%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker.moeking.me%3A6969%2Fannounce&tr=udp%3A%2F%2Ftracker-udp.gbitt.info%3A80%2Fannounce&tr=udp%3A%2F%2Fp4p.arenabg.com%3A1337%2Fannounce&tr=udp%3A%2F%2Fexplodie.org%3A6969%2Fannounce&tr=https%3A%2F%2Ftracker.gbitt.info%3A443%2Fannounce&tr=http%3A%2F%2Ftracker.gbitt.info%3A80%2Fannounce&tr=udp%3A%2F%2Fuploads.gamecoast.net%3A6969%2Fannounce
```



参考：
- Atomicals-JS部署及私有节点搭建：https://mirror.xyz/cyberscavenger.eth/rayhn9RT1VMUMo4Iios3g0A6G6AtZ-EXfQ8F_kj8HhQ
- 如何搭建 Bitcoin Core 比特币全节点：https://yishi.io/how-to-run-bitcoin-full-node/
- 如何极速同步Bitcoin 全节点：https://twitter.com/weixiaoqvq/status/1716014155730465267
- Atomicals ElectrumX 节点 Server 简易安装教程:https://twitter.com/wusimpl/status/1724769629296570724
- nextDao方案：https://github.com/Next-DAO/atomicals-electrumx-docker
- Atomicals RPC 本地部署简明教程：https://twitter.com/millsonzhou/status/1724366513912807472
- Atomicals私有节点数据下载磁力链接：https://mirror.xyz/cyberscavenger.eth/bjOEWmZt_LaQsvDj2o8_uO_X0SXdaT4S51Tfr0gva0g
- Atomicals 前景及应用研讨会 RPC 节点相关链接：https://twitter.com/millsonzhou/status/1725498224352591897
- https://twitter.com/dami16z/status/1724183137859797380
- https://note.youdao.com/s/LhXcPV2k
- https://meeting.tencent.com/user-center/shared-record-info?id=e10f9038-3038-4cb8-b45e-7f121bca1feb&from=3

